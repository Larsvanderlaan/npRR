"0",""
"0",""
"0",""
"0","get_data <- function(name,  out, type = c(""plugin"", ""IPW"")) {"
"0","  if(name == ""subst"") {"
"0","    index_plugin_glm <-grep(name, out$name, value = F)"
"0","  }"
"0","  if(""plugin"" %in% type) {"
"0","      index_plugin_glm <- intersect(grep(name, out$name, value = F), grep(""plugin"", out$name, value = F) )"
"0",""
"0","  out_sub <- out[index_plugin_glm,]"
"0","  out_sub$degree <- as.numeric(str_match(out_sub$name, ""k=([0-9]+)"")[,2])"
"0","  out_sub$est <-  sprintf(""%s (%s)"", name ,""Plugin"")"
"0","  dat1 <- out_sub"
"0","  }"
"0"," "
"0","  if(""IPW"" %in% type) {"
"0","  index_plugin_glm <- intersect(grep(name, out$name, value = F), grep(""IPW"", out$name, value = F) )"
"0","  out_sub <- out[index_plugin_glm,]"
"0","  out_sub$degree <- as.numeric(str_match(out_sub$name, ""k=([0-9]+)"")[,2])"
"0","  out_sub$est <- sprintf(""%s (%s)"", name ,""IPW"")"
"0","  dat2 <- out_sub"
"0","  }"
"0"," "
"0","  if(length(type) ==2) {"
"0","    dat <-rbind(dat1,dat2)"
"0","  }"
"0","  else if(""IPW"" %in% type) {"
"0","    dat <- dat2"
"0","  } else {"
"0","    dat <- dat1"
"0","  }"
"0","  "
"0","  lrnr_name <- stringr::str_match(dat$est, ""(.+) \\("")[,2]"
"0","  type_name <- stringr::str_match(dat$est, ""\\((.*)\\)"")[,2]"
"0","  dat$Type <- type_name"
"0","  dat$Estimator <- lrnr_name"
"0","  attr(dat, ""len"") <- index_plugin_glm"
"0","  return(dat)"
"0","}"
"0",""
"0",""
"0",""
"0",""
"0",""
"0","plot_sim <- function(dat, column = ""risk"", baseline_risk = 0, scale = F) {"
"0","   index_plugin_glm <- attr(dat, ""len"") "
"0","  "
"0","  "
"0","  if(scale) {"
"0","    dat[,column] <- dat[,column] / baseline_risk"
"0","   "
"0","  }"
"0"," "
"0","  g<- ggplot(dat, aes_string(x=""degree"", y = column, color = ""Estimator"")) + geom_point() + geom_line(aes(linetype = Type)) + scale_x_continuous( breaks =  seq(1,length(index_plugin_glm)+1,1)) + xlab(""Size of Sieve"")  + ylab(""Risk"")  + scale_linetype(name =  ""Risk Function"") #+geom_hline(aes(yintercept=baseline_risk), colour = ""black"")"
"0",""
"0","g <- g + theme(axis.text.x = element_text(size = 13),         axis.text.y = element_text(size = 17),         axis.title.x = element_text(size = 13),         axis.title.y = element_text(size = 18),         legend.text =  element_text(size = 10),         legend.title =  element_text(size = 10)) + scale_y_continuous(n.breaks = 10) +  theme_bw() "
"0"," "
"0","  "
"0","  return(g)"
"0","}"
"0",""
"0",""
"0",""
"0",""
