"0"," "
"0","      max_degrees <- c(2 )"
"0","      orders <- c(2 )"
"0",""
"0","       "
"0","      var_names <- c(""X"", ""Y"")"
"0","      nbasis_per_var <- 6"
"0","      indices <- 1:nbasis_per_var"
"0","      basis_names <- lapply(var_names, function(var) { paste0(var, indices)})"
"0","      names(basis_names) <- var_names"
"0","       "
"0","      formula_of_degree <- function(i) {"
"0","        mdegree <- max_degrees[i]"
"0","        order <- orders[i]"
"0","        terms_list <- c()"
"0","        for(deg in  mdegree) {"
"0","          terms <- combn(var_names, deg, function(...){"
"0","            basis_names_reduced <- lapply(basis_names[...], function( names ) {"
"0","              return(names[1:(2*order)])"
"0","            })"
"0","            fun <- function(x,y){"
"0","              vals <- sort(c(x,y))"
"0","              paste0(vals[1],""*"",vals[2])"
"0","            }"
"0","            "
"0","            fun <- Vectorize(fun)"
"0","            as.vector(unlist(reduce(basis_names_reduced, outer,  FUN = fun)))"
"0","          })"
"0","          terms_list <- c(terms_list, as.vector(unlist(terms)))"
"0","        }"
"0","        terms_list"
"0","          "
"0","        }"
"0","       formula <- paste0(""~ "", paste0(sort(unique(as.vector(unlist(sapply(1:length(orders), formula_of_degree))))), collapse = "" + ""), "" -1"")"
"0","       formula"
"1","[1]"
"1"," ""~ X1*Y1 + X1*Y2 + X1*Y3 + X1*Y4 + X2*Y1 + X2*Y2 + X2*Y3 + X2*Y4 + X3*Y1 + X3*Y2 + X3*Y3 + X3*Y4 + X4*Y1 + X4*Y2 + X4*Y3 + X4*Y4 -1"""
"1","
"
